var util = require('util');
var KafkaRest = require("./index.js");
var kafka = new KafkaRest({'url': 'http://localhost:8082'});

kafka.consumer("my-consumer-group-5").join({
    "format": "binary",
    "auto.commit.enable": "false",
    "auto.offset.reset": "smallest"
}, function(err, consumer_instance) {
    var stream = consumer_instance.subscribe('test');
    stream.on('data', function(msgs) {
        for(var i = 0; i < msgs.length; i++)
            console.log("Got a message: key=" + msgs[i].key + " value=" + msgs[i].value + " partition=" + msgs[i].partition);
    });
    stream.on('error', function(err) {
        console.log("Something broke: " + err);
    });
    setTimeout(function() {
        consumer_instance.shutdown(function() {
            console.log("Shutdown complete.");
        });
    }, 60000);
});